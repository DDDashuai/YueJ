const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Login-CQEewfpp.js","assets/js/vendor-TDp6YfMt.js","assets/css/vendor-BlnIT7fS.css","assets/js/_plugin-vue_export-helper-DlAUqK2U.js","assets/css/Login-CTFJVSYT.css","assets/js/Register-Bq16Ltwx.js","assets/css/Register-c5jUUrTX.css","assets/js/ForgotPassword-B7pt6myu.js","assets/css/ForgotPassword-Birfo6xz.css","assets/js/Layout-CYslKErj.js","assets/css/Layout-BLmk16KO.css","assets/js/Home-CsXxd2vx.js","assets/js/medicine-D5zlF_oL.js","assets/js/health-DHPeDlA2.js","assets/js/chat-jFtAYYM8.js","assets/js/date-mP0Ysl1n.js","assets/js/AvatarLetter-DSOdL-PP.js","assets/css/AvatarLetter-BT4FWbmy.css","assets/css/Home-Ysai0cA8.css","assets/js/Chat-C45W3r53.js","assets/css/Chat-c5ZaGBZx.css","assets/js/Health-C0_WoXt6.js","assets/css/Health-DuG778jc.css","assets/js/MedicineReminder-Dc7B6iv6.js","assets/css/MedicineReminder-DFPLl4Z8.css","assets/js/Profile-B5vo5x1p.js","assets/css/Profile-CWFaoBwB.css"])))=>i.map(i=>d[i]);
import{a as R,s as P,d as S,r as A,u as T,o as b,b as C,c as E,e as y,w as D,K as O,f as q,g as U,h as x,i as V,j as B,B as j,F,k as H,C as N,N as $,T as G,l as K,I as M,m as z,L as J,n as W,p as Y,E as Q,q as X,P as Z,D as ee,t as te,v as re,x as oe,y as ne,S as se,z as ae,A as ie,G as ce,U as ue,H as le,J as pe,M as me,O as he}from"./vendor-TDp6YfMt.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const d=document.createElement("canvas");d.width=32;d.height=32;const f=d.getContext("2d");f.beginPath();f.arc(16,16,16,0,Math.PI*2);f.fillStyle="#1989fa";f.fill();const de=d.toDataURL(),_=document.createElement("link");_.type="image/x-icon";_.rel="shortcut icon";_.href=de;document.head.appendChild(_);const h=R.create({baseURL:"http://localhost:8080",timeout:1e4,withCredentials:!0,headers:{"Content-Type":"application/json"}});h.interceptors.request.use(e=>{const t=g();return t.token&&(e.headers.Authorization=`Bearer ${t.token}`),e.method!=="options"&&(e.headers["Content-Type"]="application/json"),e},e=>Promise.reject(e));h.interceptors.response.use(e=>{const t=e.data;return t.code!==200?(P(t.message||"请求失败"),Promise.reject(new Error(t.message||"请求失败"))):t.data},e=>{var t,a,i;return((t=e.response)==null?void 0:t.status)===401&&(g().logout(),window.location.href="/login"),P(((i=(a=e.response)==null?void 0:a.data)==null?void 0:i.message)||e.message||"请求失败"),Promise.reject(e)});const g=S("user",()=>{const e=A(null),t=A(""),a=async(r,c)=>{try{if(!r||!c)throw new Error("用户名和密码不能为空");const l=await h.post("/api/user/login",{username:r,password:c});return l.user&&l.token?(e.value=l.user,t.value=l.token,localStorage.setItem("token",l.token),!0):!1}catch(l){throw console.error("登录失败:",l),l}},i=async r=>{try{if(!r.username||!r.password)throw new Error("用户名和密码不能为空");const c={username:r.username,password:r.password};return r.email&&(c.email=r.email),r.phone&&(c.phone=r.phone),await h.post("/api/user/register",c),!0}catch{return!1}},o=async()=>{try{const r=await h.get("/api/user/info");return e.value=r,!0}catch{return!1}};return{user:e,token:t,login:a,register:i,getUserInfo:o,updateUserInfo:async r=>{try{return await h.put("/api/user/info",r),!0}catch{return!1}},logout:()=>{e.value=null,t.value="",localStorage.removeItem("token")},checkAuth:async()=>{const r=localStorage.getItem("token");return r&&!t.value?(t.value=r,await o()):!!t.value}}}),fe={__name:"App",setup(e){const t=T(),a=g();return b(async()=>{const i=await a.checkAuth();!i&&t.currentRoute.value.path!=="/login"?t.push("/login"):i&&t.currentRoute.value.path==="/"&&t.push("/home")}),(i,o)=>{const s=C("router-view");return E(),y(s,null,{default:D(({Component:n})=>[(E(),y(O,null,[(E(),y(q(n)))],1024))]),_:1})}}},_e="modulepreload",ge=function(e){return"/YueJ/"+e},L={},p=function(t,a,i){let o=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),u=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));o=Promise.allSettled(a.map(r=>{if(r=ge(r),r in L)return;L[r]=!0;const c=r.endsWith(".css"),l=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${l}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":_e,c||(m.as="script"),m.crossOrigin="",m.href=r,u&&m.setAttribute("nonce",u),document.head.appendChild(m),c)return new Promise((k,I)=>{m.addEventListener("load",k),m.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${r}`)))})}))}function s(n){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=n,window.dispatchEvent(u),!u.defaultPrevented)throw n}return o.then(n=>{for(const u of n||[])u.status==="rejected"&&s(u.reason);return t().catch(s)})},ve=[{path:"/login",name:"Login",component:()=>p(()=>import("./Login-CQEewfpp.js"),__vite__mapDeps([0,1,2,3,4]))},{path:"/register",name:"Register",component:()=>p(()=>import("./Register-Bq16Ltwx.js"),__vite__mapDeps([5,1,2,3,6]))},{path:"/forgot-password",name:"ForgotPassword",component:()=>p(()=>import("./ForgotPassword-B7pt6myu.js"),__vite__mapDeps([7,1,2,3,8]))},{path:"/",component:()=>p(()=>import("./Layout-CYslKErj.js"),__vite__mapDeps([9,1,2,3,10])),redirect:"/home",children:[{path:"home",name:"Home",component:()=>p(()=>import("./Home-CsXxd2vx.js"),__vite__mapDeps([11,1,2,12,13,14,15,16,3,17,18])),meta:{requiresAuth:!0}},{path:"chat",name:"Chat",component:()=>p(()=>import("./Chat-C45W3r53.js"),__vite__mapDeps([19,14,1,2,15,16,3,17,20])),meta:{requiresAuth:!0}},{path:"health",name:"Health",component:()=>p(()=>import("./Health-C0_WoXt6.js"),__vite__mapDeps([21,13,1,2,15,3,22])),meta:{requiresAuth:!0}},{path:"medicine",name:"Medicine",component:()=>p(()=>import("./MedicineReminder-Dc7B6iv6.js"),__vite__mapDeps([23,1,2,12,3,24])),meta:{requiresAuth:!0}},{path:"profile",name:"Profile",component:()=>p(()=>import("./Profile-B5vo5x1p.js"),__vite__mapDeps([25,1,2,13,12,16,3,17,26])),meta:{requiresAuth:!0}}]}],w=U({history:x(),routes:ve});w.beforeEach(async(e,t,a)=>{console.log("Route change:",{from:t.path,to:e.path});const i=g();if(e.meta.requiresAuth&&!await i.checkAuth()){a("/login");return}a()});w.afterEach((e,t)=>{console.log("Route changed to:",e.path)});const v=V(fe),Ee=B();v.use(Ee);v.use(w);const ye=[j,F,H,N,$,G,K,M,z,J,W,Y,Q,X,Z,ee,te,re,oe,ne,se,ae,ie,ce,ue,le,pe,me,he];ye.forEach(e=>{v.component(e.name,e)});v.mount("#app");export{h as r,g as u};
