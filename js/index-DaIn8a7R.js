import{s as e,d as a,r as t,u as l,o as s,a as n,c as r,b as o,w as i,K as u,e as d,f as c,g as m,h as v,i as p,j as h,k as g,l as y,m as f,n as w,p as _,q as b,t as k,v as V,x as C,F as I,y as U,z as x,A as R,B as P,C as q,D as A,E as H,G as S,H as L,I as E,J as z,L as D,M as $,N as G,O as T,P as M,Q as N,R as O,T as B,S as j,U as F,V as Y,W as J,X as K,Y as W,Z as Q,_ as X,$ as Z,a0 as ee,a1 as ae,a2 as te,a3 as le,a4 as se,a5 as ne,a6 as re,a7 as oe,a8 as ie,a9 as ue,aa as de,ab as ce,ac as me,ad as ve}from"./vendor-CXG7zePM.js";import{a as pe}from"./utils-BoylL8Pu.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const he=document.createElement("canvas");he.width=32,he.height=32;const ge=he.getContext("2d");ge.beginPath(),ge.arc(16,16,16,0,2*Math.PI),ge.fillStyle="#1989fa",ge.fill();const ye=he.toDataURL(),fe=document.createElement("link");fe.type="image/x-icon",fe.rel="shortcut icon",fe.href=ye,document.head.appendChild(fe);const we=pe.create({baseURL:window.__VITE_BASE_URL__||"/YueJ/",timeout:1e4,withCredentials:!0});we.interceptors.request.use((e=>{const a=_e();return a.token&&(e.headers.Authorization=`Bearer ${a.token}`),"options"!==e.method&&(e.headers["Content-Type"]="application/json"),e}),(e=>Promise.reject(e))),we.interceptors.response.use((a=>{const t=a.data;return 200!==t.code?(e(t.message||"请求失败"),Promise.reject(new Error(t.message||"请求失败"))):t.data}),(a=>{var t,l,s;if(401===(null==(t=a.response)?void 0:t.status)){_e().logout(),window.location.href="/login"}return e((null==(s=null==(l=a.response)?void 0:l.data)?void 0:s.message)||a.message||"请求失败"),Promise.reject(a)}));const _e=a("user",(()=>{const e=t(null),a=t(""),l=async()=>{try{const a=await we.get("/api/user/info");return e.value=a,!0}catch(a){return!1}};return{user:e,token:a,login:async(t,l)=>{try{if(!t||!l)throw new Error("用户名和密码不能为空");const s=await we.post("/api/user/login",{username:t,password:l});return!(!s.user||!s.token)&&(e.value=s.user,a.value=s.token,localStorage.setItem("token",s.token),!0)}catch(s){throw s}},register:async e=>{try{if(!e.username||!e.password)throw new Error("用户名和密码不能为空");const a={username:e.username,password:e.password};return e.email&&(a.email=e.email),e.phone&&(a.phone=e.phone),await we.post("/api/user/register",a),!0}catch(a){return!1}},getUserInfo:l,updateUserInfo:async e=>{try{return await we.put("/api/user/info",e),!0}catch(a){return!1}},logout:()=>{e.value=null,a.value="",localStorage.removeItem("token")},checkAuth:async()=>{const e=localStorage.getItem("token");return e&&!a.value?(a.value=e,await l()):!!a.value}}})),be={__name:"App",setup(e){const a=l(),t=_e();return s((async()=>{const e=await t.checkAuth();e||"/login"===a.currentRoute.value.path?e&&"/"===a.currentRoute.value.path&&a.push("/home"):a.push("/login")})),(e,a)=>{const t=n("router-view");return o(),r(t,null,{default:i((({Component:e})=>[(o(),r(u,null,[(o(),r(d(e)))],1024))])),_:1})}}},ke=(e,a)=>{const t=e.__vccOpts||e;for(const[l,s]of a)t[l]=s;return t},Ve={class:"login-page"},Ce={class:"login-form"},Ie={class:"form-actions"},Ue=ke({__name:"Login",setup(a){const s=l(),r=_e(),u=t(!1),d=c({username:"",password:""}),f=async()=>{u.value=!0,h({message:"登录中...",forbidClick:!0});try{await r.login(d.username,d.password)?(e({type:"success",message:"登录成功"}),await s.push("/")):e({type:"fail",message:"用户名或密码错误"})}catch(a){e({type:"fail",message:a.message||"登录失败，请稍后重试"})}finally{u.value=!1,g()}},w=()=>{s.push("/register")},_=()=>{s.push("/forgot-password")};return(e,a)=>{const t=n("van-icon"),l=n("van-field"),s=n("van-cell-group"),r=n("van-button"),c=n("van-form");return o(),m("div",Ve,[a[6]||(a[6]=v("div",{class:"login-header"},[v("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}),v("h2",{class:"title"},"老年人健康管理平台")],-1)),v("div",Ce,[p(c,{onSubmit:f,class:"form-content"},{default:i((()=>[p(s,{inset:""},{default:i((()=>[p(l,{modelValue:d.username,"onUpdate:modelValue":a[0]||(a[0]=e=>d.username=e),name:"username",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"}]},{label:i((()=>[p(t,{name:"user-o",class:"field-icon"}),a[2]||(a[2]=v("span",{class:"field-label"},"用户名",-1))])),_:1},8,["modelValue"]),p(l,{modelValue:d.password,"onUpdate:modelValue":a[1]||(a[1]=e=>d.password=e),type:"password",name:"password",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},{label:i((()=>[p(t,{name:"lock",class:"field-icon"}),a[3]||(a[3]=v("span",{class:"field-label"},"密码",-1))])),_:1},8,["modelValue"])])),_:1}),v("div",Ie,[p(r,{round:"",block:"",type:"primary","native-type":"submit",loading:u.value},{default:i((()=>a[4]||(a[4]=[y(" 登录 ")]))),_:1},8,["loading"]),v("div",{class:"action-links"},[v("span",{class:"link",onClick:w},"注册账号"),a[5]||(a[5]=v("span",{class:"divider"},"|",-1)),v("span",{class:"link",onClick:_},"忘记密码")])])])),_:1})]),a[7]||(a[7]=v("div",{class:"login-footer"},[v("p",{class:"copyright"},"© 2024 健康管理平台 版权所有")],-1))])}}},[["__scopeId","data-v-0d317b9d"]]),xe=ke({__name:"TabBar",setup(e){const a=f(),s=l(),u=t(0),d={"/home":0,"/health":1,"/chat":2,"/medicine":3,"/profile":4};w((()=>a.path),(e=>{u.value=d[e]??0}),{immediate:!0});const c=()=>{s.push("/chat")},m=e=>{};return(e,a)=>{const t=n("van-tabbar-item"),l=n("van-tabbar");return o(),r(l,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),route:"",onChange:m},{default:i((()=>[p(t,{name:"home",to:"/home",icon:"home-o"},{default:i((()=>a[1]||(a[1]=[y(" 首页 ")]))),_:1}),p(t,{name:"health",to:"/health",icon:"records"},{default:i((()=>a[2]||(a[2]=[y(" 健康 ")]))),_:1}),p(t,{name:"chat",icon:"chat-o",onClick:c},{default:i((()=>a[3]||(a[3]=[y(" 问诊 ")]))),_:1}),p(t,{name:"medicine",to:"/medicine",icon:"clock-o"},{default:i((()=>a[4]||(a[4]=[y(" 用药 ")]))),_:1}),p(t,{name:"profile",to:"/profile",icon:"user-o"},{default:i((()=>a[5]||(a[5]=[y(" 我的 ")]))),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-12480f73"]]),Re={class:"layout"},Pe=ke({__name:"Layout",setup(e){const a=f(),t=["/login","/register","/forgot-password"],l=_((()=>!t.includes(a.path))),s=_((()=>"/chat"===a.path));return(e,a)=>{const t=n("router-view");return o(),m("div",Re,[p(t,null,{default:i((({Component:e})=>[(o(),r(u,{include:["Home","Chat","Health","Medicine","Profile"]},[(o(),r(d(e)))],1024))])),_:1}),l.value&&!s.value?(o(),r(xe,{key:0})):b("",!0)])}}},[["__scopeId","data-v-f6f73d94"]]),qe=a("medicine",(()=>{const e=t([]),a=t([]);return{reminders:e,activeReminders:a,addReminder:async a=>{try{if(!a.medicineName||!a.dosage||!a.frequency)throw new Error("请填写完整信息");const t={...a,nextRemindTime:(new Date).toISOString(),status:"ACTIVE"},l=await we.post("/api/medicine/reminder",t);return e.value.unshift(l),!0}catch(t){return!1}},getReminders:async a=>{try{const t=await we.get(`/api/medicine/reminder/${a}`);return e.value=t,!0}catch(t){return!1}},getActiveReminders:async e=>{try{const t=await we.get(`/api/medicine/reminder/active/${e}`);return a.value=t,!0}catch(t){return!1}},updateReminder:async(a,t)=>{try{await we.put(`/api/medicine/reminder/${a}`,t);const l=e.value.findIndex((e=>e.reminderId===a));return-1!==l&&(e.value[l]={...e.value[l],...t}),!0}catch(l){return!1}},deleteReminder:async a=>{try{return await we.delete(`/api/medicine/reminder/${a}`),e.value=e.value.filter((e=>e.reminderId!==a)),!0}catch(t){return!1}}}})),Ae=a("health",(()=>{const e=_e(),a=t(null),l=t([]);return{healthData:a,healthHistory:l,addHealthData:async a=>{var t;try{if(!(null==(t=e.user)?void 0:t.userId))throw new Error("用户未登录");const l={...a,userId:e.user.userId},s=await we.post("/api/health",l);return l.value=s,!0}catch(l){return!1}},getLatestHealth:async e=>{try{if(!e)throw new Error("用户ID不能为空");const t=await we.get(`/api/health/latest/${e}`);return t&&(a.value=t),!0}catch(t){return!1}},getHealthHistory:async e=>{try{if(!e)throw new Error("用户ID不能为空");const a=await we.get(`/api/health/user/${e}`);return a&&(l.value=a),!0}catch(a){return!1}},deleteHealthRecord:async e=>{try{if(!e)throw new Error("记录ID不能为空");return await we.delete(`/api/health/${e}`),!0}catch(a){return!1}}}})),He=a("chat",(()=>{const e=t([]),a=t([]),l=t(null),s=async()=>{try{const a=await we.post("/api/chat/group/create");return l.value=a.data,e.value=[],a.data}catch(a){throw a}};return{chatHistory:e,chatGroups:a,currentGroupId:l,createChatGroup:s,getChatGroups:async e=>{const t=await we.get(`/api/chat/groups/${e}`);return a.value=t,t},loadGroupChat:async(a,t)=>{try{l.value=t;const s=await we.get(`/api/chat/group/${a}/${t}`),n=s.data||s;if(!Array.isArray(n))throw new Error("无效的聊天记录格式");const r=[];return n.forEach((e=>{e.message&&r.push({type:"user",message:e.message,createdAt:e.createdAt,chatGroupId:e.chatGroupId}),e.response&&r.push({type:"ai",response:e.response,createdAt:e.createdAt,chatGroupId:e.chatGroupId,loading:!1})})),r.sort(((e,a)=>new Date(e.createdAt)-new Date(a.createdAt))),e.value=r,r}catch(s){throw s}},sendMessage:async a=>{l.value||(l.value=await s()),a.chatGroupId=l.value;try{if(!a.userId)throw new Error("用户未登录");e.value.push({type:"user",message:a.message,createdAt:(new Date).toISOString(),chatGroupId:l.value});const t={type:"ai",loading:!0};e.value.push(t);const s=await we.post("/api/chat/text",a),n=e.value.indexOf(t);return-1!==n&&(e.value[n]={type:"ai",message:s.data.message,response:s.data.response,createdAt:s.data.createdAt,loading:!1,chatGroupId:l.value}),s}catch(t){throw e.value=e.value.filter((e=>e!==loadingMessage)),t}},sendImage:async a=>{var t;try{const l=null==(t=userStore.user)?void 0:t.userId;if(!l)throw new Error("用户未登录");const s={type:"ai",loading:!0};e.value.push(s),a.append("userId",l);const n=await we.post("/api/chat/image",a,{headers:{"Content-Type":"multipart/form-data"}}),r=e.value.indexOf(s);return-1!==r&&(e.value[r]={...n,type:"ai",loading:!1}),n}catch(l){throw e.value=e.value.filter((e=>e!==loadingMessage)),l}}}})),Se=e=>{if(!e)return"";const a=new Date(e);return`${a.getFullYear()}-${Ee(a.getMonth()+1)}-${Ee(a.getDate())}`},Le=e=>{if(!e)return"";const a=new Date(e);return`${Se(a)} ${Ee(a.getHours())}:${Ee(a.getMinutes())}`},Ee=e=>e<10?`0${e}`:e,ze=ke({__name:"AvatarLetter",props:{username:{type:String,required:!0},size:{type:Number,default:40}},setup(e){const a=e,t=_((()=>a.username?a.username.charAt(0).toUpperCase():"?")),l=_((()=>{const e=["#9E9E9E","#757575","#616161","#424242","#BDBDBD"];return e[a.username.length%e.length]}));return(a,s)=>(o(),m("div",{class:"avatar-letter",style:V({width:e.size+"px",height:e.size+"px",fontSize:.4*e.size+"px",backgroundColor:l.value})},k(t.value),5))}},[["__scopeId","data-v-3930fd70"]]),De={class:"home-page"},$e={class:"header"},Ge={class:"user-info"},Te={class:"user-detail"},Me={class:"username"},Ne={class:"health-overview card"},Oe={class:"card-header"},Be={class:"health-grid"},je={class:"item-label"},Fe={class:"item-unit"},Ye={class:"medicine-reminders card"},Je={class:"card-header"},Ke={class:"reminder-list"},We={key:0,class:"empty-tip"},Qe={class:"reminder-time"},Xe={class:"reminder-content"},Ze={class:"medicine-reminders card"},ea={class:"card-header"},aa={class:"chat-list"},ta=["onClick"],la={class:"chat-icon"},sa={class:"chat-info"},na={class:"chat-time"},ra={class:"chat-preview"},oa={key:0,class:"empty-state"},ia=ke({__name:"Home",setup(a){const u=l(),d=_e(),c=qe(),h=Ae(),g=He(),f=t([{type:"bloodPressure",label:"血压",value:null,unit:"mmHg"},{type:"heartRate",label:"心率",value:null,unit:"次/分"},{type:"bloodSugar",label:"血糖",value:null,unit:"mmol/L"},{type:"weight",label:"体重",value:null,unit:"kg"}]),w=t([]),_=t([]),V=t(!1),R=t([]);s((async()=>{var e;(null==(e=d.user)?void 0:e.userId)&&await Promise.all([P(),q(),A(),H()])}));const P=async()=>{await h.getLatestHealth(d.user.userId)&&h.healthData&&S(h.healthData)},q=async()=>{await c.getActiveReminders(d.user.userId)&&(w.value=c.activeReminders)},A=async()=>{await g.getChatHistory(d.user.userId)&&(_.value=g.chatHistory)},H=async()=>{var e;if(null==(e=d.user)?void 0:e.userId){V.value=!0;try{const e=await g.getChatGroups(d.user.userId);R.value=e.slice(0,3)}catch(a){}finally{V.value=!1}}},S=e=>{f.value=f.value.map((a=>{const t=e[a.type];return{...a,value:t||"--"}}))},L=()=>u.push("/health"),E=()=>u.push("/medicine"),z=()=>{u.push("/chat")};return(a,t)=>{var l,s;const h=n("van-button"),_=n("van-skeleton"),P=n("van-icon");return o(),m("div",De,[v("div",$e,[v("div",Ge,[p(ze,{username:(null==(l=C(d).user)?void 0:l.username)||"?",size:60},null,8,["username"]),v("div",Te,[v("h3",Me,k((null==(s=C(d).user)?void 0:s.username)||"未登录"),1),t[0]||(t[0]=v("p",{class:"welcome"},"欢迎使用健康管理平台",-1))])])]),v("div",Ne,[v("div",Oe,[t[2]||(t[2]=v("h3",null,"今日健康概览",-1)),p(h,{size:"small",type:"primary",plain:"",onClick:L},{default:i((()=>t[1]||(t[1]=[y(" 查看详情 ")]))),_:1})]),v("div",Be,[(o(!0),m(I,null,U(f.value,(e=>(o(),m("div",{class:"health-item",key:e.type},[v("span",je,k(e.label),1),v("span",{class:x(["item-value",e.status])},k(e.value||"--"),3),v("span",Fe,k(e.unit),1)])))),128))])]),v("div",Ye,[v("div",Je,[t[4]||(t[4]=v("h3",null,"用药提醒",-1)),p(h,{size:"small",type:"primary",plain:"",onClick:E},{default:i((()=>t[3]||(t[3]=[y(" 全部提醒 ")]))),_:1})]),v("div",Ke,[0===w.value.length?(o(),m("div",We," 暂无用药提醒 ")):(o(!0),m(I,{key:1},U(w.value,(e=>(o(),m("div",{key:e.reminderId,class:"reminder-item"},[v("div",Qe,k(C(Le)(e.nextRemindTime)),1),v("div",Xe,[v("h4",null,k(e.medicineName),1),v("p",null,k(e.dosage),1)]),p(h,{size:"small",type:"primary",onClick:a=>(async e=>{await c.updateReminder(e,{status:"COMPLETED"})&&await q()})(e.reminderId)},{default:i((()=>t[5]||(t[5]=[y(" 已服用 ")]))),_:2},1032,["onClick"])])))),128))])]),v("div",Ze,[v("div",ea,[t[7]||(t[7]=v("span",{class:"title"},"最近会诊",-1)),p(h,{size:"small",plain:"",round:"",onClick:z},{default:i((()=>t[6]||(t[6]=[y(" 开始问诊 ")]))),_:1})]),v("div",aa,[V.value?(o(),r(_,{key:0,title:"",row:2,loading:V.value},null,8,["loading"])):(o(),m(I,{key:1},[(o(!0),m(I,null,U(R.value,(a=>(o(),m("div",{key:a.chat_group_id,class:"chat-item",onClick:t=>(async a=>{try{await g.loadGroupChat(d.user.userId,a.chat_group_id),u.push("/chat")}catch(t){e("加载聊天记录失败")}})(a)},[v("div",la,[p(P,{name:"western"===a.conversationType?"cluster-o":"flower-o",size:"24"},null,8,["name"])]),v("div",sa,[v("div",na,k(C(Se)(a.created_at)),1),v("div",ra,k(a.last_message),1)]),p(P,{name:"arrow",class:"arrow-icon"})],8,ta)))),128)),0===R.value.length?(o(),m("div",oa," 暂无会诊记录 ")):b("",!0)],64))])])])}}},[["__scopeId","data-v-681cb16d"]]),ua={class:"chat-page"},da={class:"message-list"},ca={key:0,class:"message-content user"},ma={class:"avatar"},va={class:"message-content ai"},pa={key:0,class:"typing"},ha={key:1,class:"ai-response"},ga={class:"input-area"},ya={class:"type-select"},fa={class:"type-options"},wa=["onClick"],_a={class:"message-input-wrapper"},ba={class:"toolbar-left"},ka={class:"history-container"},Va={class:"message-count"},Ca=ke(Object.assign({name:"Chat"},{__name:"Chat",setup(a){const u=l(),d=_e(),c=He(),h=t(null),g=t(""),f=t(!1),_=t(!1),b=t(!1),V=t(!1),P=t(!1),q=t([]),A=t([]),H=t("western"),S=[{text:"西医咨询",value:"western"},{text:"中医咨询",value:"traditional"}],L=t(!1);w((()=>c.chatHistory.length),(()=>{z()})),s((()=>{E()}));const E=async()=>{var e;(null==(e=d.user)?void 0:e.userId)&&(await c.getChatGroups(d.user.userId),c.currentGroupId||await c.createChatGroup(),z())},z=async()=>{await R(),h.value&&(h.value.scrollTop=h.value.scrollHeight)},D=()=>{u.back()},$=async()=>{var a;if(g.value.trim()){if(!(null==(a=d.user)?void 0:a.userId))return e("请先登录"),void u.push("/login");f.value=!0;try{await c.sendMessage({userId:d.user.userId,message:g.value,type:"user",conversationType:H.value}),g.value=""}catch(t){e("发送失败")}finally{f.value=!1}}},G=a=>{if(!a.type.startsWith("image/"))return e("请上传图片文件"),!1;return!!(a.size/1024/1024<2)||(e("图片大小不能超过2MB"),!1)},T=async a=>{var t;if(!(null==(t=d.user)?void 0:t.userId))return e("请先登录"),void u.push("/login");const l=new FormData;l.append("image",a.file),l.append("conversationType",H.value);try{await c.sendImage(l),A.value=[]}catch(s){e("图片分析失败")}},M=()=>{_.value=!0,N()},N=async()=>{var a;if(!b.value&&(null==(a=d.user)?void 0:a.userId))try{const e=await c.getChatGroups(d.user.userId);q.value=e,V.value=!0}catch(t){e("加载历史记录失败")}finally{b.value=!1}},O=async()=>{P.value=!0;try{await N()}finally{P.value=!1}},B=async()=>{var a;try{if(!(null==(a=d.user)?void 0:a.userId))return e("请先登录"),void u.push("/login");await c.createChatGroup(),c.chatHistory=[],_.value=!1,g.value="",H.value="western",e("新建聊天成功")}catch(t){e("新建聊天失败")}};return(a,t)=>{const l=n("van-nav-bar"),s=n("van-loading"),u=n("van-icon"),w=n("van-popover"),E=n("van-uploader"),j=n("van-field"),F=n("van-button"),Y=n("van-form"),J=n("van-cell"),K=n("van-list"),W=n("van-pull-refresh"),Q=n("van-popup");return o(),m("div",ua,[p(l,{title:"智能问诊","left-arrow":"","right-text":"历史",onClickLeft:D,onClickRight:M,class:"chat-nav"}),v("div",{class:"chat-content",ref_key:"chatContainer",ref:h},[v("div",da,[(o(!0),m(I,null,U(C(c).chatHistory,((e,a)=>(o(),m("div",{key:a,class:x(["message","user"===e.type?"message-right":"message-left"])},["user"===e.type?(o(),m("div",ca,k(e.message),1)):(o(),m(I,{key:1},[v("div",ma,[p(ze,{username:"AI",size:40})]),v("div",va,[e.loading?(o(),m("div",pa,[p(s,{type:"spinner",size:"20"}),t[7]||(t[7]=v("span",null,"AI正在思考...",-1))])):(o(),m("div",ha,k(e.response),1))])],64))],2)))),128))])],512),v("div",ga,[p(w,{show:L.value,"onUpdate:show":t[0]||(t[0]=e=>L.value=e),placement:"top-start",theme:"light",trigger:"click"},{reference:i((()=>[p(u,{name:"western"===H.value?"cluster-o":"flower-o",size:"20",class:"toolbar-icon"},null,8,["name"])])),default:i((()=>[v("div",ya,[v("div",fa,[(o(),m(I,null,U(S,(e=>v("div",{key:e.value,class:x(["type-option",{active:H.value===e.value}]),onClick:a=>(e=>{H.value=e,L.value=!1})(e.value)},[p(u,{name:"western"===e.value?"cluster-o":"flower-o",class:"type-icon"},null,8,["name"]),y(" "+k(e.text),1)],10,wa))),64))])])])),_:1},8,["show"]),p(Y,{onSubmit:$,class:"input-form"},{default:i((()=>[v("div",_a,[v("div",ba,[p(E,{modelValue:A.value,"onUpdate:modelValue":t[1]||(t[1]=e=>A.value=e),"max-count":1,"before-read":G,"after-read":T},{default:i((()=>[p(u,{name:"add-o",size:"20",class:"toolbar-icon"})])),_:1},8,["modelValue"])]),p(j,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=e=>g.value=e),placeholder:"请描述您的症状或者健康问题...",autosize:{minHeight:24,maxHeight:72},type:"textarea",class:"message-field"},null,8,["modelValue"]),p(F,{type:"primary",size:"small",loading:f.value,"native-type":"submit",class:"send-btn",round:""},{default:i((()=>t[8]||(t[8]=[y(" 发送 ")]))),_:1},8,["loading"])])])),_:1})]),p(Q,{show:_.value,"onUpdate:show":t[6]||(t[6]=e=>_.value=e),position:"right",style:{width:"80%",height:"100%"},"z-index":"1000"},{default:i((()=>[v("div",ka,[p(l,{title:"聊天历史","left-arrow":"",onClickLeft:t[3]||(t[3]=e=>_.value=!1)},{right:i((()=>[p(u,{name:"plus",size:"20",onClick:B})])),_:1}),p(W,{modelValue:P.value,"onUpdate:modelValue":t[5]||(t[5]=e=>P.value=e),onRefresh:O},{default:i((()=>[p(K,{loading:b.value,"onUpdate:loading":t[4]||(t[4]=e=>b.value=e),finished:V.value,"finished-text":"没有更多了",onLoad:N},{default:i((()=>[(o(!0),m(I,null,U(q.value,((a,t)=>(o(),r(J,{key:t,title:C(Se)(a.created_at),label:a.last_message,"is-link":"",onClick:t=>(async a=>{try{if(_.value=!1,!a.chat_group_id)return void e("无效的聊天记录");await c.loadGroupChat(d.user.userId,a.chat_group_id),await R(),z()}catch(t){e("加载聊天记录失败")}})(a)},{value:i((()=>[v("span",Va,k(a.message_count)+"条消息",1)])),_:2},1032,["title","label","onClick"])))),128))])),_:1},8,["loading","finished"])])),_:1},8,["modelValue"])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-ebc0542b"]]),Ia={class:"health-page"},Ua={class:"data-overview card"},xa={class:"data-item"},Ra={class:"unit"},Pa={class:"data-label"},qa={key:0,class:"data-trend"},Aa={class:"data-input card"},Ha={class:"card-header"},Sa={style:{margin:"16px"}},La={class:"data-history card"},Ea={class:"card-header"},za={key:1,class:"history-list"},Da={class:"history-date"},$a={class:"history-content"},Ga={class:"history-data"},Ta={class:"value"},Ma={class:"filter-container"},Na={class:"filter-content"},Oa={class:"filter-actions"},Ba=ke({__name:"Health",setup(a){const u=Ae(),d=_e(),h=l(),g=t([{type:"bloodPressure",label:"血压",value:null,unit:"mmHg",status:""},{type:"heartRate",label:"心率",value:null,unit:"次/分",status:""},{type:"bloodSugar",label:"血糖",value:null,unit:"mmol/L",status:""},{type:"weight",label:"体重",value:null,unit:"kg",status:""}]),f=t(new Date),w=c({bloodPressure:"",heartRate:"",bloodSugar:"",weight:""}),_=t([]),V=t(!1),R=t(!1),q=t([]),A=[{label:"血压",value:"bloodPressure"},{label:"心率",value:"heartRate"},{label:"血糖",value:"bloodSugar"},{label:"体重",value:"weight"}];s((async()=>{var e;(null==(e=d.user)?void 0:e.userId)&&await H()}));const H=async()=>{var a;if(!(null==(a=d.user)?void 0:a.userId))return e("请先登录"),void h.push("/login");try{await Promise.all([S(),L()])}catch(t){e("数据加载失败")}},S=async()=>{await u.getLatestHealth(d.user.userId)&&u.healthData&&E(u.healthData)},L=async()=>{await u.getHealthHistory(d.user.userId)&&(_.value=u.healthHistory)},E=e=>{e&&(g.value=g.value.map((a=>{const t=e[a.type];return{...a,value:t||"--"}})))},z=async()=>{var a;if(!(null==(a=d.user)?void 0:a.userId))return e("请先登录"),void h.push("/login");try{const a={...w,date:f.value};await u.addHealthData(a)?(e("保存成功"),await H(),D()):e("保存失败")}catch(t){e(t.message||"保存失败")}},D=()=>{Object.keys(w).forEach((e=>w[e]=""))},$=()=>{V.value=!0},G=e=>{f.value=e,V.value=!1},T=()=>{R.value=!0},M=async()=>{R.value=!1},N=()=>{q.value=[]};return(a,t)=>{const l=n("van-nav-bar"),s=n("van-icon"),d=n("van-col"),c=n("van-row"),h=n("van-button"),H=n("van-field"),S=n("van-cell-group"),E=n("van-form"),D=n("van-empty"),O=n("van-datetime-picker"),B=n("van-popup"),j=n("van-cell"),F=n("van-checkbox"),Y=n("van-checkbox-group");return o(),m("div",Ia,[p(l,{title:"健康数据"}),v("div",Ua,[p(c,null,{default:i((()=>[(o(!0),m(I,null,U(g.value,(e=>(o(),r(d,{span:"12",key:e.type},{default:i((()=>[v("div",xa,[v("div",{class:x(["data-value",e.status])},[y(k(e.value||"--")+" ",1),v("span",Ra,k(e.unit),1)],2),v("div",Pa,k(e.label),1),e.trend?(o(),m("div",qa,[p(s,{name:e.trend>0?"arrow-up":"arrow-down",color:e.trend>0?"#ee0a24":"#07c160"},null,8,["name","color"]),y(" "+k(Math.abs(e.trend))+"% ",1)])):b("",!0)])])),_:2},1024)))),128))])),_:1})]),v("div",Aa,[v("div",Ha,[t[11]||(t[11]=v("h3",null,"数据录入",-1)),p(h,{size:"small",type:"primary",onClick:$},{default:i((()=>[y(k(C(Se)(f.value)),1)])),_:1})]),p(E,{onSubmit:z},{default:i((()=>[p(S,{inset:""},{default:i((()=>[p(H,{modelValue:w.bloodPressure,"onUpdate:modelValue":t[0]||(t[0]=e=>w.bloodPressure=e),label:"血压",placeholder:"请输入血压值","right-icon":"question-o",onClickRightIcon:t[1]||(t[1]=a=>{e({bloodPressure:"收缩压/舒张压，如：120/80",heartRate:"正常范围：60-100次/分",bloodSugar:"空腹正常范围：3.9-6.1mmol/L",weight:"请输入实际体重"}["bloodPressure"])})},{"right-icon":i((()=>t[12]||(t[12]=[v("span",{class:"unit-text"},"mmHg",-1)]))),_:1},8,["modelValue"]),p(H,{modelValue:w.heartRate,"onUpdate:modelValue":t[2]||(t[2]=e=>w.heartRate=e),type:"digit",label:"心率",placeholder:"请输入心率值"},{"right-icon":i((()=>t[13]||(t[13]=[v("span",{class:"unit-text"},"次/分",-1)]))),_:1},8,["modelValue"]),p(H,{modelValue:w.bloodSugar,"onUpdate:modelValue":t[3]||(t[3]=e=>w.bloodSugar=e),type:"digit",label:"血糖",placeholder:"请输入血糖值"},{"right-icon":i((()=>t[14]||(t[14]=[v("span",{class:"unit-text"},"mmol/L",-1)]))),_:1},8,["modelValue"]),p(H,{modelValue:w.weight,"onUpdate:modelValue":t[4]||(t[4]=e=>w.weight=e),type:"digit",label:"体重",placeholder:"请输入体重"},{"right-icon":i((()=>t[15]||(t[15]=[v("span",{class:"unit-text"},"kg",-1)]))),_:1},8,["modelValue"])])),_:1}),v("div",Sa,[p(h,{round:"",block:"",type:"primary","native-type":"submit"},{default:i((()=>t[16]||(t[16]=[y(" 保存记录 ")]))),_:1})])])),_:1})]),v("div",La,[v("div",Ea,[t[18]||(t[18]=v("h3",null,"历史记录",-1)),p(h,{size:"small",plain:"",type:"primary",onClick:T},{default:i((()=>t[17]||(t[17]=[y(" 筛选 ")]))),_:1})]),0===_.value.length?(o(),r(D,{key:0,description:"暂无记录"})):(o(),m("div",za,[(o(!0),m(I,null,U(_.value,(a=>(o(),m("div",{key:a.healthRecordId,class:"history-item"},[v("div",Da,k(C(Se)(a.updateTime)),1),v("div",$a,[v("div",Ga,[t[19]||(t[19]=v("span",{class:"label"},"血压",-1)),v("span",Ta,k(a.bloodPressure)+"mmHg",1)])]),p(h,{size:"small",type:"danger",plain:"",onClick:t=>{var l;(l=a.healthRecordId)?P({title:"确认删除",message:"确定要删除这条记录吗？",showCancelButton:!0}).then((async()=>{try{await u.deleteHealthRecord(l)?(e("删除成功"),await L()):e("删除失败")}catch(a){e("删除失败")}})):e("记录ID不能为空")}},{default:i((()=>t[20]||(t[20]=[y(" 删除 ")]))),_:2},1032,["onClick"])])))),128))]))]),p(B,{show:V.value,"onUpdate:show":t[7]||(t[7]=e=>V.value=e),position:"bottom"},{default:i((()=>[p(O,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=e=>f.value=e),type:"date",title:"选择日期","max-date":new Date,onConfirm:G,onCancel:t[6]||(t[6]=e=>V.value=!1)},null,8,["modelValue","max-date"])])),_:1},8,["show"]),p(B,{show:R.value,"onUpdate:show":t[10]||(t[10]=e=>R.value=e),position:"right",style:{width:"80%",height:"100%"}},{default:i((()=>[v("div",Ma,[p(l,{title:"筛选条件","left-arrow":"",onClickLeft:t[8]||(t[8]=e=>R.value=!1)}),v("div",Na,[p(S,null,{default:i((()=>[p(j,{title:"时间范围"},{"right-icon":i((()=>[p(h,{size:"small",onClick:a.showDateRangePicker},{default:i((()=>t[21]||(t[21]=[y(" 选择时间 ")]))),_:1},8,["onClick"])])),_:1}),p(j,{title:"数据类型"},{"right-icon":i((()=>[p(Y,{modelValue:q.value,"onUpdate:modelValue":t[9]||(t[9]=e=>q.value=e)},{default:i((()=>[(o(),m(I,null,U(A,(e=>p(F,{key:e.value,name:e.value},{default:i((()=>[y(k(e.label),1)])),_:2},1032,["name"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1}),v("div",Oa,[p(h,{block:"",type:"primary",onClick:M},{default:i((()=>t[22]||(t[22]=[y(" 应用筛选 ")]))),_:1}),p(h,{block:"",plain:"",onClick:N},{default:i((()=>t[23]||(t[23]=[y(" 重置 ")]))),_:1})])])])])),_:1},8,["show"])])}}},[["__scopeId","data-v-5c93dc6c"]]),ja={class:"medicine-reminder"},Fa={style:{margin:"16px"}},Ya=ke({__name:"MedicineReminder",setup(a){const u=l(),d=_e(),h=qe(),g=t(0),f=t(!1),w=t(!1),_=t(!1),b=t([]),V=c({medicineName:"",dosage:"",frequency:"",notes:""}),C=()=>{u.back()},x=async a=>{var t;try{if(!(null==(t=d.user)?void 0:t.userId))return e("请先登录"),void u.push("/login");const a={medicineName:V.medicineName,dosage:V.dosage,frequency:V.frequency,notes:V.notes,nextRemindTime:(new Date).toISOString()};await h.addReminder(a)?(e("添加成功"),R(),g.value=1,await P()):e("添加失败")}catch(l){e(l.message||"添加失败")}},R=()=>{V.medicineName="",V.dosage="",V.frequency="",V.notes=""},P=async()=>{var a;f.value=!0,w.value=!1,b.value=[];try{(null==(a=d.user)?void 0:a.userId)&&(await h.getReminders(d.user.userId),b.value=h.reminders)}catch(t){e("获取数据失败")}finally{f.value=!1,w.value=!0}},H=async()=>{_.value=!0;try{await P()}finally{_.value=!1}},S=async()=>{f.value||await P()};s((async()=>{await P()}));return(e,a)=>{const t=n("van-nav-bar"),l=n("van-field"),s=n("van-cell-group"),u=n("van-button"),d=n("van-form"),c=n("van-tab"),h=n("van-tag"),R=n("van-cell"),P=n("van-list"),L=n("van-pull-refresh"),E=n("van-tabs");return o(),m("div",ja,[p(t,{title:"用药助手","left-arrow":"",onClickLeft:C}),p(E,{active:g.value,"onUpdate:active":a[6]||(a[6]=e=>g.value=e),sticky:"",style:{"margin-top":"20px"}},{default:i((()=>[p(c,{title:"添加提醒",style:{"margin-top":"20px"}},{default:i((()=>[p(d,{onSubmit:x},{default:i((()=>[p(s,{inset:""},{default:i((()=>[p(l,{modelValue:V.medicineName,"onUpdate:modelValue":a[0]||(a[0]=e=>V.medicineName=e),name:"medicineName",label:"药品名称",placeholder:"请输入药品名称",rules:[{required:!0,message:"请填写药品名称"}]},null,8,["modelValue"]),p(l,{modelValue:V.dosage,"onUpdate:modelValue":a[1]||(a[1]=e=>V.dosage=e),name:"dosage",label:"用药剂量",placeholder:"请输入用药剂量",rules:[{required:!0,message:"请填写用药剂量"}]},null,8,["modelValue"]),p(l,{modelValue:V.frequency,"onUpdate:modelValue":a[2]||(a[2]=e=>V.frequency=e),name:"frequency",label:"服药频率",placeholder:"如：每天三次",rules:[{required:!0,message:"请填写服药频率"}]},null,8,["modelValue"]),p(l,{modelValue:V.notes,"onUpdate:modelValue":a[3]||(a[3]=e=>V.notes=e),name:"notes",label:"备注",type:"textarea",placeholder:"请输入备注信息",rows:"2"},null,8,["modelValue"])])),_:1}),v("div",Fa,[p(u,{round:"",block:"",type:"primary","native-type":"submit"},{default:i((()=>a[7]||(a[7]=[y(" 添加提醒 ")]))),_:1})])])),_:1})])),_:1}),p(c,{title:"提醒列表"},{default:i((()=>[p(L,{modelValue:_.value,"onUpdate:modelValue":a[5]||(a[5]=e=>_.value=e),onRefresh:H},{default:i((()=>[p(P,{loading:f.value,"onUpdate:loading":a[4]||(a[4]=e=>f.value=e),finished:w.value,"finished-text":"没有更多了",onLoad:S},{default:i((()=>[(o(!0),m(I,null,U(b.value,(e=>(o(),r(s,{key:e.reminderId,inset:"",style:{"margin-top":"20px"}},{default:i((()=>{return[p(R,{title:e.medicineName,label:e.frequency},{"right-icon":i((()=>[p(h,{type:"ACTIVE"===e.status?"success":"warning"},{default:i((()=>[y(k("ACTIVE"===e.status?"进行中":"已完成"),1)])),_:2},1032,["type"])])),_:2},1032,["title","label"]),p(R,{title:"用药剂量",value:e.dosage},null,8,["value"]),p(R,{title:"下次提醒",value:(t=e.nextRemindTime,new Date(t).toLocaleString())},null,8,["value"]),p(R,{title:"备注",label:e.notes},null,8,["label"]),p(R,null,{"right-icon":i((()=>[p(u,{size:"small",type:"danger",onClick:a=>(async()=>{try{q("删除成功"),H()}catch(e){A("删除失败")}})(e.reminderId)},{default:i((()=>a[8]||(a[8]=[y(" 删除 ")]))),_:2},1032,["onClick"])])),_:2},1024)];var t})),_:2},1024)))),128))])),_:1},8,["loading","finished"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["active"])])}}},[["__scopeId","data-v-4d2513a8"]]),Ja={class:"profile-page"},Ka={class:"user-card"},Wa={class:"avatar-edit"},Qa={class:"username"},Xa={class:"menu-list"},Za={class:"menu-group"},et={class:"menu-group"},at={class:"menu-group"},tt={class:"menu-group"},lt={class:"logout-btn"},st={class:"popup-content"},nt=ke({__name:"Profile",setup(a){const r=l(),u=_e(),d=Ae(),c=qe(),h=t(!1),g=t(!1),f=t(!1),w=t(0),_=t({username:"",email:"",phone:"",age:"",gender:""}),b=["男","女","其他"],V=[{name:"拍照",value:"camera"},{name:"从相册选择",value:"album"}];s((async()=>{var e;(null==(e=u.user)?void 0:e.userId)&&await Promise.all([I(),U()])}));const I=async()=>{const e=await u.getUserInfo();e&&(_.value={...e})},U=async()=>{w.value=0},x=()=>{h.value=!0},R=async e=>{e.value,h.value=!1},q=()=>{g.value=!0},A=async()=>{try{await u.updateUserInfo(_.value),e("保存成功"),g.value=!1}catch(a){e("保存失败")}},H=e=>{_.value.gender=e,f.value=!1},S=()=>{r.push("/health")},L=()=>{r.push("/medicine")},E=()=>{r.push("/medicine/history")},z=()=>{r.push("/notifications")},D=()=>{r.push("/chat")},$=()=>{r.push("/settings/notifications")},G=()=>{r.push("/settings/privacy")},T=()=>{r.push("/about")},M=()=>{P({title:"提示",message:"确认退出登录？",showCancelButton:!0}).then((async e=>{"confirm"===e&&(await u.logout(),r.replace("/login"))}))};return(e,a)=>{var t,l;const s=n("van-icon"),r=n("van-cell"),I=n("van-badge"),U=n("van-cell-group"),P=n("van-button"),N=n("van-action-sheet"),O=n("van-nav-bar"),B=n("van-field"),j=n("van-form"),F=n("van-popup"),Y=n("van-picker");return o(),m("div",Ja,[v("div",Ka,[v("div",{class:"avatar-wrapper",onClick:x},[p(ze,{username:(null==(t=C(u).user)?void 0:t.username)||"?",size:80},null,8,["username"]),v("div",Wa,[p(s,{name:"photograph"})])]),v("h2",Qa,k(null==(l=C(u).user)?void 0:l.username),1)]),v("div",Xa,[v("div",Za,[a[11]||(a[11]=v("div",{class:"group-title"},"个人资料",-1)),p(U,{inset:""},{default:i((()=>[p(r,{title:"基本信息","is-link":"",onClick:q}),p(r,{title:"健康档案","is-link":"",onClick:S},{"right-icon":i((()=>[p(I,{content:C(d).unreadCount||""},null,8,["content"])])),_:1})])),_:1})]),v("div",et,[a[12]||(a[12]=v("div",{class:"group-title"},"用药管理",-1)),p(U,{inset:""},{default:i((()=>[p(r,{title:"用药提醒","is-link":"",onClick:L},{"right-icon":i((()=>[p(I,{content:C(c).activeReminders.length||""},null,8,["content"])])),_:1}),p(r,{title:"用药记录","is-link":"",onClick:E})])),_:1})]),v("div",at,[a[13]||(a[13]=v("div",{class:"group-title"},"消息通知",-1)),p(U,{inset:""},{default:i((()=>[p(r,{title:"系统通知","is-link":"",onClick:z},{"right-icon":i((()=>[p(I,{content:w.value},null,8,["content"])])),_:1}),p(r,{title:"问诊记录","is-link":"",onClick:D})])),_:1})]),v("div",tt,[a[14]||(a[14]=v("div",{class:"group-title"},"系统设置",-1)),p(U,{inset:""},{default:i((()=>[p(r,{title:"通知设置","is-link":"",onClick:$}),p(r,{title:"隐私设置","is-link":"",onClick:G}),p(r,{title:"关于我们","is-link":"",onClick:T})])),_:1})])]),v("div",lt,[p(P,{block:"",type:"danger",onClick:M},{default:i((()=>a[15]||(a[15]=[y(" 退出登录 ")]))),_:1})]),p(N,{show:h.value,"onUpdate:show":a[0]||(a[0]=e=>h.value=e),actions:V,"cancel-text":"取消",onSelect:R},null,8,["show"]),p(F,{show:g.value,"onUpdate:show":a[8]||(a[8]=e=>g.value=e),position:"bottom",round:"",style:{height:"70%"}},{default:i((()=>[v("div",st,[p(O,{title:"基本信息","left-arrow":"",onClickLeft:a[1]||(a[1]=e=>g.value=!1)},{right:i((()=>[p(P,{type:"primary",size:"small",onClick:A},{default:i((()=>a[16]||(a[16]=[y(" 保存 ")]))),_:1})])),_:1}),p(j,{onSubmit:A},{default:i((()=>[p(U,{inset:""},{default:i((()=>[p(B,{modelValue:_.value.username,"onUpdate:modelValue":a[2]||(a[2]=e=>_.value.username=e),label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请输入用户名"}]},null,8,["modelValue"]),p(B,{modelValue:_.value.email,"onUpdate:modelValue":a[3]||(a[3]=e=>_.value.email=e),label:"邮箱",placeholder:"请输入邮箱",rules:[{required:!0,message:"请输入邮箱"},{pattern:/.+@.+/,message:"请输入正确的邮箱格式"}]},null,8,["modelValue"]),p(B,{modelValue:_.value.phone,"onUpdate:modelValue":a[4]||(a[4]=e=>_.value.phone=e),label:"手机号",placeholder:"请输入手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}]},null,8,["modelValue"]),p(B,{modelValue:_.value.age,"onUpdate:modelValue":a[5]||(a[5]=e=>_.value.age=e),label:"年龄",type:"number",placeholder:"请输入年龄"},null,8,["modelValue"]),p(B,{modelValue:_.value.gender,"onUpdate:modelValue":a[6]||(a[6]=e=>_.value.gender=e),label:"性别",readonly:"","is-link":"",onClick:a[7]||(a[7]=e=>f.value=!0)},null,8,["modelValue"])])),_:1})])),_:1})])])),_:1},8,["show"]),p(F,{show:f.value,"onUpdate:show":a[10]||(a[10]=e=>f.value=e),position:"bottom",round:""},{default:i((()=>[p(Y,{columns:b,onConfirm:H,onCancel:a[9]||(a[9]=e=>f.value=!1),"show-toolbar":""})])),_:1},8,["show"])])}}},[["__scopeId","data-v-17f44418"]]),rt={class:"register-page"},ot={class:"register-form"},it={class:"form-actions"},ut={class:"agreement"},dt={class:"agreement-content"},ct={class:"forgot-password-page"},mt={class:"step-indicator"},vt={class:"form-container"},pt={class:"form-actions"},ht={class:"form-container"},gt={class:"form-actions"},yt={class:"success-container"},ft=[{path:"/login",name:"Login",component:Ue},{path:"/register",name:"Register",component:ke({__name:"Register",setup(a){const s=l(),r=_e(),u=c({username:"",password:"",confirmPassword:"",phone:"",verifyCode:""}),d=t(!1),h=t(!1);t(0);const g=t(!1),f=e=>e===u.password,w=()=>{s.back()},_=async()=>{if(d.value){h.value=!0;try{await r.register(u)&&P({title:"注册成功",message:"是否立即登录？",showCancelButton:!0}).then((()=>{s.push("/login")}))}catch(a){e("注册失败")}finally{h.value=!1}}else e("请先同意用户协议和隐私政策")},b=()=>{g.value=!0},k=()=>{};return(e,a)=>{const t=n("van-nav-bar"),l=n("van-field"),s=n("van-cell-group"),r=n("van-button"),c=n("van-checkbox"),V=n("van-form"),C=n("van-popup");return o(),m("div",rt,[p(t,{title:"注册账号","left-arrow":"",onClickLeft:w}),v("div",ot,[p(V,{onSubmit:_},{default:i((()=>[p(s,{inset:""},{default:i((()=>[p(l,{modelValue:u.username,"onUpdate:modelValue":a[0]||(a[0]=e=>u.username=e),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),p(l,{modelValue:u.password,"onUpdate:modelValue":a[1]||(a[1]=e=>u.password=e),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6位"}]},null,8,["modelValue"]),p(l,{modelValue:u.confirmPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>u.confirmPassword=e),type:"password",name:"confirmPassword",label:"确认密码",placeholder:"请再次输入密码",rules:[{required:!0,message:"请确认密码"},{validator:f,message:"两次密码不一致"}]},null,8,["modelValue","rules"]),p(l,{modelValue:u.phone,"onUpdate:modelValue":a[3]||(a[3]=e=>u.phone=e),type:"tel",name:"phone",label:"手机号",placeholder:"请输入手机号（选填）",rules:[{pattern:/^1[3-9]\d{9}$/,message:"手机号格式错误"}]},null,8,["modelValue"])])),_:1}),v("div",it,[p(r,{round:"",block:"",type:"primary","native-type":"submit",loading:h.value},{default:i((()=>a[7]||(a[7]=[y(" 注册 ")]))),_:1},8,["loading"]),v("div",ut,[p(c,{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=e=>d.value=e),shape:"square"},{default:i((()=>[a[8]||(a[8]=y(" 我已阅读并同意 ")),v("span",{class:"link",onClick:H(b,["stop"])},"《用户协议》"),a[9]||(a[9]=y(" 和 ")),v("span",{class:"link",onClick:H(k,["stop"])},"《隐私政策》")])),_:1},8,["modelValue"])])])])),_:1})]),p(C,{show:g.value,"onUpdate:show":a[6]||(a[6]=e=>g.value=e),position:"bottom",round:"",style:{height:"70%"}},{default:i((()=>[v("div",dt,[p(t,{title:"用户协议","left-arrow":"",onClickLeft:a[5]||(a[5]=e=>g.value=!1)}),a[10]||(a[10]=v("div",{class:"agreement-text"},null,-1))])])),_:1},8,["show"])])}}},[["__scopeId","data-v-9acbe6d7"]])},{path:"/forgot-password",name:"ForgotPassword",component:ke({__name:"ForgotPassword",setup(a){const s=l(),r=t(0),u=t(0),d=c({phone:"",verifyCode:"",newPassword:"",confirmPassword:""}),h=e=>e===d.newPassword,g=()=>{r.value>0?r.value--:s.back()},f=async()=>{if(/^1[3-9]\d{9}$/.test(d.phone))try{u.value=60;const e=setInterval((()=>{u.value--,u.value<=0&&clearInterval(e)}),1e3)}catch(a){e("验证码发送失败")}else e("请输入正确的手机号")},w=async()=>{try{r.value=1}catch(a){e("验证失败")}},_=async()=>{try{r.value=2}catch(a){e("密码重置失败")}},b=()=>{s.replace("/login")};return(e,a)=>{const t=n("van-nav-bar"),l=n("van-step"),s=n("van-steps"),c=n("van-field"),V=n("van-button"),C=n("van-cell-group"),I=n("van-form"),U=n("van-empty");return o(),m("div",ct,[p(t,{title:"找回密码","left-arrow":"",onClickLeft:g}),v("div",mt,[p(s,{active:r.value},{default:i((()=>[p(l,null,{default:i((()=>a[4]||(a[4]=[y("验证身份")]))),_:1}),p(l,null,{default:i((()=>a[5]||(a[5]=[y("重置密码")]))),_:1}),p(l,null,{default:i((()=>a[6]||(a[6]=[y("完成")]))),_:1})])),_:1},8,["active"])]),S(v("div",vt,[p(I,{onSubmit:w},{default:i((()=>[p(C,{inset:""},{default:i((()=>[p(c,{modelValue:d.phone,"onUpdate:modelValue":a[0]||(a[0]=e=>d.phone=e),type:"tel",label:"手机号",placeholder:"请输入注册手机号",rules:[{required:!0,message:"请填写手机号"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式错误"}]},null,8,["modelValue"]),p(c,{modelValue:d.verifyCode,"onUpdate:modelValue":a[1]||(a[1]=e=>d.verifyCode=e),center:"",clearable:"",label:"验证码",placeholder:"请输入验证码",rules:[{required:!0,message:"请填写验证码"}]},{button:i((()=>[p(V,{size:"small",type:"primary",disabled:!!u.value,onClick:f},{default:i((()=>[y(k(u.value?`${u.value}s后重试`:"获取验证码"),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1}),v("div",pt,[p(V,{round:"",block:"",type:"primary","native-type":"submit"},{default:i((()=>a[7]||(a[7]=[y(" 下一步 ")]))),_:1})])])),_:1})],512),[[L,0===r.value]]),S(v("div",ht,[p(I,{onSubmit:_},{default:i((()=>[p(C,{inset:""},{default:i((()=>[p(c,{modelValue:d.newPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>d.newPassword=e),type:"password",label:"新密码",placeholder:"请输入新密码",rules:[{required:!0,message:"请填写新密码"},{min:6,message:"密码至少6位"}]},null,8,["modelValue"]),p(c,{modelValue:d.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>d.confirmPassword=e),type:"password",label:"确认密码",placeholder:"请再次输入新密码",rules:[{required:!0,message:"请确认密码"},{validator:h,message:"两次密码不一致"}]},null,8,["modelValue","rules"])])),_:1}),v("div",gt,[p(V,{round:"",block:"",type:"primary","native-type":"submit"},{default:i((()=>a[8]||(a[8]=[y(" 确认修改 ")]))),_:1})])])),_:1})],512),[[L,1===r.value]]),S(v("div",yt,[p(U,{image:"success",description:"密码重置成功"},{bottom:i((()=>[p(V,{round:"",type:"primary",class:"bottom-button",onClick:b},{default:i((()=>a[9]||(a[9]=[y(" 立即登录 ")]))),_:1})])),_:1})],512),[[L,2===r.value]])])}}},[["__scopeId","data-v-baba88a9"]])},{path:"/",component:Pe,redirect:"/home",children:[{path:"home",name:"Home",component:ia,meta:{requiresAuth:!0}},{path:"chat",name:"Chat",component:Ca,meta:{requiresAuth:!0}},{path:"health",name:"Health",component:Ba,meta:{requiresAuth:!0}},{path:"medicine",name:"Medicine",component:Ya,meta:{requiresAuth:!0}},{path:"profile",name:"Profile",component:nt,meta:{requiresAuth:!0}}]}],wt=E({history:z(),routes:ft});wt.beforeEach((async(e,a,t)=>{const l=_e();if(e.meta.requiresAuth){if(!(await l.checkAuth()))return void t("/login")}t()}));const _t=window.__VITE_BASE_URL__||"/YueJ/";window.__dynamic_base__=_t;const bt=D(be),kt=$();bt.use(kt),bt.use(wt);[G,T,M,N,O,B,j,F,Y,J,K,W,Q,X,Z,ee,ae,te,le,se,ne,re,oe,ie,ue,de,ce,me,ve].forEach((e=>{bt.component(e.name,e)})),bt.mount("#app");
